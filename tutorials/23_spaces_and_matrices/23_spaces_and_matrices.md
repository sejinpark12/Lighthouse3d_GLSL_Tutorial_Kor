# GLSL Tutorial - 공간과 행렬

| [목차](../../README.md) | 이전: 셰이더 간 통신 | 다음: 보간 문제 |
| :---------------------- | --------------------------------------------------------------------------: | -----------------: |

셰이더를 보여주기 전에, 공간과 행렬에 대해서 조금 이야기를 할 것입니다. 우리는 주로 파이프라인 내부의 많은 공간에서 작업하기 때문에 이것들은 기본이 되는 개념들입니다. 그리고 셰이더에서 실제로 어떤 동작이 일어나고 있는지 이해하기 위해 공통점을 찾는 것은 중요합니다.

컴퓨터 그래픽스에서 우리의 목적에 맞는 4개의 관련된 공간은 다음과 같습니다:
- 로컬 공간 : 모델이 생성되는 공간
- 월드 공간 : 3D 씬을 조립하는 공간
- 카메라 공간 : 카메라가 원점에 위치하고 Z축의 음의 방향을 바라보는 공간
- 클립 공간 : 뷰 프러스텀이 원점이 중앙에 위치하고 모든 축이 -1 ~ 1 범위에 있는 정육면체로 변형된 포스트 프로젝션 공간

이 4개의 공간 사이의 변환을 위해서는 3개의 4x4 행렬이 필요합니다:
- 모델 행렬 : 로컬 공간을 월드 공간으로 변환
- 뷰 행렬 : 월드 공간을 카메라 공간으로 변환
- 프로젝션 행렬 : 카메라 공간을 클립 공간으로 변환

다음과 같이 행렬을 합성하면 연산을 편리하게 처리할 수 있습니다:
- $viewModel = view \times model$
- $projViewModel = projection \times view \times model$

위의 행렬을 사용하면 공간 사이의 변환을 더 빠르게 하고 다이어그램에서 인접하지 않은 공간으로의 변환에 필요한 덧셈, 곱셈 연산량을 줄일 수 있습니다.

*model* 행렬과 *view* 행렬은 일반적으로 이동(translation), 회전(rotations), 크기조절(scales)을 바탕으로 생성됩니다. 이 기하학적 변환은 아핀 변환(affine transformations)을 나타냅니다. 즉, 직선과 비율을 유지하는 변환 - 직선 상에 세 점이 존재한다면, 변환 후에도 직선 상에 존재하고 직선의 변환된 중점은 여전히 변환된 직선의 중점이 됩니다. 또한 각도나 길이가 반드시 유지되는 것은 아니지만 두 평행한 직선은 변환 후에도 평행을 유지합니다.

동차 좌표계를 사용하는 일반적인 아핀 변환의 행렬은 마지막 행이 [0 0 0 1]입니다. 마지막 열은 이동에 대한 변환을 담고 있고, 위쪽 3x3 부분 행렬은 회전과 크기조절에 대한 변환을 나타냅니다.

여기서는 처음 세 공간(로컬, 월드, 카메라) 사이의 변환을 고려할 때, 아핀 변환에 대해서만 고려할 것입니다.

프로젝션 행렬은 일반적으로 원근 투영(perspective projection)을 나타냅니다. 원근 투영은 투영 후에 평행선이 평행을 유지하지 않기 때문에 동일한 변환 클래스에 속하지 않습니다. 따라서 원근 투영은 아핀 변환이 아닙니다.

### 로컬 공간, 월드 공간, 카메라 공간 사이의 변환

점 (x, y, z, 1.0)의 공간 변환을 하기 위해서 위의 행렬을 사용합니다. 예를 들어, 점 $P$ 을 로컬 공간에서 카메라 공간으로 변환하기 위해서는 다음과 같이 작성합니다:

$$P' = view \times model \times P = viewModel \times P$$

오직 아핀 변환만을 고려하기 때문에 변환된 점은 (x', y', z', 1.0)의 일반적인 형태입니다.

벡터 $(x,\ y,\ z,\ 0.0)$ 는 동일한 절차로 변환됩니다. 그리고 변환된 벡터는 $(x',\ y',\ z',\ 0.0)$ 의 형태입니다. 특히, 벡터의 네 번째 원소는 0이기 때문에, 벡터의 처음 원소 3개와 위쪽 3x3 부분 행렬을 사용하여 동일한 결과를 얻을 수 있습니다.



| [목차](../../README.md) | 이전: 셰이더 간 통신 | 다음: 보간 문제 |
| :---------------------- | --------------------------------------------------------------------------: | -----------------: |

## 출처

http://www.lighthouse3d.com/tutorials/glsl-tutorial/spaces-and-matrices/
