# GLSL Tutorial - 레스터라이제이션과 보간

| [목차](../../README.md) | 이전: 지오메트리 셰이더 예제 | 다음: 프레그먼트 셰이더 |
| :---------------------- | --------------------------------------------------------: | ---------------------------: |

<p align="center"><img src="../../images/07_rasterization/07_rasterization1.png" width="700"></p>

이번 색션에서는 그래픽스 파이프라인을 이해를 위한 두 가지 중요 개념인 레스터라이제이션(rasterizatio)과 보간(interpolation)을 다룹니다. 그래픽스 파이프라인에서 이 두 가지 단계는 고정 함수입니다. 즉, 프로그래밍을 할 수 없습니다.

하지만 레스터라이제이션이 수행되기 전에, 지금 설명할 몇 가지 작은 과정들이 있습니다. 이 과정에서 윈도우 좌표 변환을 클리핑(clipping)합니다.

**클리핑**

이 단계는 변환 버텍스가 조합된 프리미티브를 받고, 클리핑 볼륨 안쪽에 위치하는지 확인합니다. 프리미티브의 모든 부분이 클리핑 볼륨 안쪽에 위치한다면 해당 프리미티브는 변경되지 않습니다. 뷰 볼륨 밖에 있는 프리미티브는 제거됩니다. 클리핑 볼륨의 경계에서 모서리가 교차되는 프리미티브는 클리핑 됩니다.

클리핑 볼륨은 뷰 프러스텀 내부에 있는 모든 버텍스가 $(x_c,\ y_c,\ z_c,\ w_c)$ 좌표를 가지도록 뷰 프러스텀의 변환한 것입니다.

$$-w_c \leq x_c \leq w_c$$
$$-w_c \leq y_c \leq w_c$$
$$-w_c \leq z_c \leq w_c$$

버텍스의 `gl_Position` 속성은 클립 좌표를 가지며 클리핑 목적으로 테스트됩니다. 버텍스 클립 좌표는 $(x_c,\ y_c,\ z_c,\ w_c)$입니다.

버텍스가 클리핑 볼륨 경계면의 반대쪽에 위치한 모서리를 가진 프리미티브인 경우, 교차된 각 클리핑 평면에 대해 교차점에서 새로운 버텍스가 계산됩니다. 새 버텍스들은 해당 프리미티브의 일부분으로 포함되고, 클리핑 볼륨 바깥쪽의 버텍스들은 제거됩니다. 따라서 클리핑은 삼각형 프리미티브에 새 버텍스들을 추가할 수 있지만 프로그래머에게는 보이지 않습니다.

다음 그림에서 클리핑 볼륨 밖으로 일부분이 나온 삼각형이 어떻게 되는지 보여줍니다.

<p align="center"><img src="../../images/07_rasterization/07_rasterization2.png" width="700"></p>

새 버텍스는 각 모서리를 따라 보간된 관련 속성을 가집니다. 플랫 셰이딩(flat shading)은 속성 선언에서 지정되며 이 경우 속성값은 모서리를 따라 일정합니다.
그러면 버텍스를 원근 분할(perspective division)이라고도 하는 정규화 장치 좌표(NDC : normalized device coordinates)로 변환할 수 있습니다. 즉, $(x_d,\ y_d,\ z_d) = (x_c/w_c,\ y_c/w_c,\ z_c/w_c)$이 됩니다.

정규화 장치 좌표로 변환하면 클립 볼륨은 모든 좌표가 -1부터 1의 범위인 3D 큐브가 됩니다(깊이 클램핑(depth clamping)이 비활성화되지 않는 한 z값의 제한이 없습니다). 그러므로, 버텍스는 깊이 클램핑할 경우 다음과 같이 클리핑 볼륨 안에 위치합니다:

$$-1 \leq x_d \leq 1$$
$$-1 \leq y_d \leq 1$$
$$-1 \leq z_d \leq 1$$

**플랫 셰이딩**



<p align="center"><img src="../../images/07_rasterization/07_rasterization3.png" width="300"></p>

<p align="center"><img src="../../images/07_rasterization/07_rasterization4.png" width="300"></p>

| [목차](../../README.md) | 이전: 지오메트리 셰이더 예제 | 다음: 프레그먼트 셰이더 |
| :---------------------- | --------------------------------------------------------: | ---------------------------: |

## 출처

http://www.lighthouse3d.com/tutorials/glsl-tutorial/rasterization-and-interpolation/